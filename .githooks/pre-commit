#!/bin/sh
# Validate staged YAML files before commit

STAGED_YAML=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(yml|yaml)$')

if [ -z "$STAGED_YAML" ]; then
  exit 0
fi

echo "Validating staged YAML files..."
bundle exec rake validate_yaml
EXIT_CODE=$?

if [ $EXIT_CODE -ne 0 ]; then
  echo "‚ùå YAML validation failed. Fix errors before committing."
  exit 1
fi

exit 0
